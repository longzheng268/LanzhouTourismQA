# æ•°æ®åº“åŒæ¨¡å¼å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ä¾èµ–é…ç½® âœ…
**æ–‡ä»¶**ï¼š`build.gradle.kts`

æ·»åŠ äº†MariaDBå’ŒHikariCPä¾èµ–ï¼š
```kotlin
// MariaDB JDBCé©±åŠ¨
implementation("org.mariadb.jdbc:mariadb-java-client:3.3.2")
// HikariCPè¿æ¥æ± 
implementation("com.zaxxer:HikariCP:5.1.0")
```

### 2. æ•°æ®æ¨¡å‹ âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/model/Models.kt`

æ–°å¢æ•°æ®åº“é…ç½®ç±»ï¼š
```kotlin
@Serializable
data class DatabaseConfig(
    val enabled: Boolean = false,
    val host: String = "localhost",
    val port: Int = 3306,
    val database: String = "qa_database",
    val username: String = "root",
    val password: String = "",
    val maximumPoolSize: Int = 10,
    val minimumIdle: Int = 2,
    val connectionTimeout: Int = 30000
)
```

### 3. æ•°æ®åº“ç®¡ç†å™¨ âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/database/DatabaseManager.kt`

å®Œæ•´å®ç°ï¼ŒåŒ…å«ï¼š
- âœ… HikariCPè¿æ¥æ± ç®¡ç†
- âœ… æ•°æ®åº“è¿æ¥åˆå§‹åŒ–
- âœ… æŸ¥è¯¢æ‰€æœ‰é—®ç­”å¯¹ï¼ˆqa_pairsï¼‰
- âœ… æŸ¥è¯¢æŒ‡å®šæ•°é‡é—®ç­”å¯¹ï¼ˆæ”¯æŒåˆ†é¡µï¼‰
- âœ… æœç´¢é—®ç­”å¯¹ï¼ˆå…³é”®è¯åŒ¹é…ï¼‰
- âœ… ä¿å­˜èŠå¤©å†å²ï¼ˆchat_historyï¼‰
- âœ… æŸ¥è¯¢èŠå¤©å†å²
- âœ… æ’å…¥ç¤ºä¾‹æ•°æ®
- âœ… è·å–ç»Ÿè®¡ä¿¡æ¯
- âœ… æµ‹è¯•è¿æ¥
- âœ… å…³é—­è¿æ¥

**ä¸SQLè„šæœ¬å®Œå…¨å…¼å®¹**ï¼š
- è¡¨åï¼š`qa_pairs`, `chat_history`
- å­—æ®µï¼š`id`, `question`, `answer`, `timestamp`
- æ•°æ®åº“åï¼š`qa_database`

### 4. é…ç½®ç®¡ç†å™¨ âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/config/ConfigManager.kt`

æ–°å¢æ–¹æ³•ï¼š
```kotlin
fun loadDatabaseConfig(): DatabaseConfig
```

### 5. é…ç½®æ–‡ä»¶ âœ…
**æ–‡ä»¶**ï¼š`src/main/resources/config.json`

æ·»åŠ æ•°æ®åº“é…ç½®ï¼š
```json
"database": {
    "enabled": false,
    "host": "localhost",
    "port": 3306,
    "database": "qa_database",
    "username": "root",
    "password": "",
    "maximumPoolSize": 10,
    "minimumIdle": 2,
    "connectionTimeout": 30000
}
```

### 6. æ ¸å¿ƒæœåŠ¡ âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/service/QAService.kt`

**åŒæ¨¡å¼å®ç°**ï¼š
- æ‡’åŠ è½½çŸ¥è¯†åº“ï¼ˆ`knowledgeItems`ï¼‰
- æ•°æ®åº“æ¨¡å¼ï¼šä»`qa_pairs`è¡¨åŠ è½½
- JSONæ¨¡å¼ï¼šä»`knowledge_base.json`åŠ è½½
- è‡ªåŠ¨å›é€€æœºåˆ¶ï¼šæ•°æ®åº“å¤±è´¥æ—¶è‡ªåŠ¨ä½¿ç”¨JSON

**æ–°å¢åŠŸèƒ½**ï¼š
- âœ… `testDatabaseConnection()` - æµ‹è¯•æ•°æ®åº“è¿æ¥
- âœ… `getChatHistory()` - è·å–èŠå¤©å†å²
- âœ… `close()` - å…³é—­æ•°æ®åº“è¿æ¥
- âœ… å¼‚æ­¥ä¿å­˜èŠå¤©å†å²ï¼ˆä¸é˜»å¡UIï¼‰

### 7. ä¸»ç¨‹åº âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/Main.kt`

æ·»åŠ èµ„æºæ¸…ç†ï¼š
```kotlin
onCloseRequest = {
    service.close()  // å…³é—­æ•°æ®åº“è¿æ¥
    exitApplication()
}
```

### 8. UIç•Œé¢ âœ…
**æ–‡ä»¶**ï¼š`src/main/kotlin/com/lanzhou/qa/ui/QuestionAnswerScreen.kt`

å¢å¼ºç»Ÿè®¡åŠŸèƒ½ï¼š
- æ˜¾ç¤ºæ•°æ®æ¥æºï¼ˆæ•°æ®åº“/JSONï¼‰
- æ˜¾ç¤ºæ•°æ®åº“QAå¯¹æ•°é‡
- æ˜¾ç¤ºèŠå¤©å†å²æ•°é‡

### 9. æ–‡æ¡£ âœ…

#### ä½¿ç”¨æ–‡æ¡£.md
- âœ… æ–°å¢"æ•°æ®åº“åŒæ¨¡å¼è¯´æ˜"ç« èŠ‚
- âœ… æ¨¡å¼å¯¹æ¯”è¡¨æ ¼
- âœ… é…ç½®æ–¹æ³•è¯¦è§£
- âœ… æ•°æ®åº“ç‰¹æ€§è¯´æ˜
- âœ… æ•…éšœå¤„ç†æŒ‡å—
- âœ… æ–°å¢FAQé—®é¢˜

#### æ•°æ®åº“åˆå§‹åŒ–è¯´æ˜.md
- âœ… å®Œæ•´çš„æ•°æ®åº“é…ç½®æŒ‡å—
- âœ… SQLè„šæœ¬è¯´æ˜
- âœ… è¿æ¥æ–¹æ³•ï¼ˆDBeaver/å‘½ä»¤è¡Œ/PowerShellï¼‰
- âœ… éªŒè¯æ­¥éª¤
- âœ… æ¨¡å¼åˆ‡æ¢æ–¹æ³•
- âœ… æ•…éšœæ’é™¤

#### README.md
- âœ… æ›´æ–°é¡¹ç›®ç‰¹ç‚¹ï¼ˆæ·»åŠ åŒæ¨¡å¼ï¼‰
- âœ… æ·»åŠ æ•°æ®åº“æ¨¡å¼è¯´æ˜

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### åŒæ¨¡å¼æ¶æ„
```
QAService
â”œâ”€â”€ æ•°æ®åº“æ¨¡å¼ (enabled=true)
â”‚   â”œâ”€â”€ è¿æ¥MariaDB
â”‚   â”œâ”€â”€ åŠ è½½qa_pairsè¡¨
â”‚   â””â”€â”€ ä¿å­˜åˆ°chat_history
â”‚
â””â”€â”€ JSONæ¨¡å¼ (enabled=false)
    â””â”€â”€ åŠ è½½knowledge_base.json
```

### è‡ªåŠ¨å›é€€æœºåˆ¶
```
å¯åŠ¨ â†’ æ£€æŸ¥enabled
  â†“
true â†’ å°è¯•è¿æ¥æ•°æ®åº“
  â†“
æˆåŠŸ â†’ ä½¿ç”¨æ•°æ®åº“
å¤±è´¥ â†’ å›é€€åˆ°JSON + æ˜¾ç¤ºè­¦å‘Š
```

### èŠå¤©å†å²æµç¨‹
```
ç”¨æˆ·æé—® â†’ RAGæ£€ç´¢ â†’ MIMO API â†’ ä¿å­˜åˆ°æ•°æ®åº“
                                      â†“
                                chat_historyè¡¨
```

## ğŸ“Š å…¼å®¹æ€§

### ä¸C++ç‰ˆæœ¬å¯¹æ¯”
| ç‰¹æ€§ | C++ç‰ˆæœ¬ | Kotlinç‰ˆæœ¬ |
|------|---------|-----------|
| æ•°æ®åº“ | MariaDB | MariaDB |
| è¡¨ç»“æ„ | âœ… å…¼å®¹ | âœ… å…¼å®¹ |
| é…ç½® | config.json | config.json |
| API | MIMO | MIMO |
| èŠå¤©å†å² | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| RAGæ¶æ„ | âœ… | âœ… |
| GUI | ImGui | Compose Desktop |

### æ•°æ®åº“è¡¨ç»“æ„å…¼å®¹
```sql
-- C++å’ŒKotlinç‰ˆæœ¬å…±ç”¨
CREATE TABLE qa_pairs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    question VARCHAR(500) NOT NULL,
    answer TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE chat_history (
    id INT PRIMARY KEY AUTO_INCREMENT,
    question TEXT NOT NULL,
    answer TEXT NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### é»˜è®¤ï¼šJSONæ¨¡å¼
æ— éœ€ä»»ä½•é…ç½®ï¼Œå¼€ç®±å³ç”¨ï¼š
```bash
.\\build.ps1
.\\run.ps1
```

### å¯é€‰ï¼šæ•°æ®åº“æ¨¡å¼
1. ä¿®æ”¹ `config.json`ï¼š
```json
"database": { "enabled": true, "host": "localhost", "username": "root", "password": "your_password" }
```

2. æ‰§è¡ŒSQLè„šæœ¬ï¼ˆC++é¡¹ç›®ä¸­çš„setup_database_fixed.sqlï¼‰

3. è¿è¡Œç¨‹åº

## ğŸ” æµ‹è¯•éªŒè¯

### è¿æ¥æµ‹è¯•
```
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ: localhost:3306/qa_database
ğŸ”„ ä½¿ç”¨æ•°æ®åº“æ¨¡å¼åŠ è½½çŸ¥è¯†åº“...
âœ… ä»æ•°æ®åº“åŠ è½½äº† 25 æ¡çŸ¥è¯†
```

### UIç»Ÿè®¡æ˜¾ç¤º
```
ğŸ“Š ç³»ç»Ÿç»Ÿè®¡
æ•°æ®æ¥æº: æ•°æ®åº“
çŸ¥è¯†åº“æ¡ç›®: 25æ¡
åˆ†ç±»æ•°é‡: 9ç±»
æ•°æ®åº“QAå¯¹: 25æ¡
èŠå¤©å†å²: 3æ¡
```

### æ•°æ®åº“éªŒè¯
```sql
-- æ£€æŸ¥çŸ¥è¯†åº“
SELECT COUNT(*) FROM qa_database.qa_pairs;  -- åº”è¯¥è¿”å›25

-- æ£€æŸ¥èŠå¤©å†å²
SELECT * FROM qa_database.chat_history ORDER BY timestamp DESC LIMIT 1;
```

## ğŸ“ é…ç½®ç¤ºä¾‹

### JSONæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
```json
{
  "database": {
    "enabled": false
  }
}
```
- å¯åŠ¨å¿«
- æ— éœ€æ•°æ®åº“
- é€‚åˆä¸ªäººä½¿ç”¨

### æ•°æ®åº“æ¨¡å¼
```json
{
  "database": {
    "enabled": true,
    "host": "localhost",
    "port": 3306,
    "database": "qa_database",
    "username": "root",
    "password": "your_password",
    "maximumPoolSize": 10,
    "minimumIdle": 2,
    "connectionTimeout": 30000
  }
}
```
- æ•°æ®æŒä¹…åŒ–
- èŠå¤©å†å²è®°å½•
- é€‚åˆç”Ÿäº§ç¯å¢ƒ

## ğŸ‰ æ€»ç»“

### å®Œæˆåº¦ï¼š100%
- âœ… æ‰€æœ‰ä¾èµ–å·²æ·»åŠ 
- âœ… æ•°æ®åº“ç®¡ç†å™¨å®Œæ•´å®ç°
- âœ… åŒæ¨¡å¼æ— ç¼åˆ‡æ¢
- âœ… è‡ªåŠ¨å›é€€æœºåˆ¶
- âœ… èŠå¤©å†å²è®°å½•
- âœ… UIå¢å¼ºæ˜¾ç¤º
- âœ… å®Œæ•´æ–‡æ¡£

### ä¼˜åŠ¿
1. **çµæ´»æ€§**ï¼šå¯æ ¹æ®éœ€è¦é€‰æ‹©æ¨¡å¼
2. **å…¼å®¹æ€§**ï¼šä¸C++ç‰ˆæœ¬æ•°æ®åº“å®Œå…¨å…¼å®¹
3. **å¯é æ€§**ï¼šè‡ªåŠ¨å›é€€æœºåˆ¶ç¡®ä¿ç¨‹åºå¯ç”¨
4. **æ˜“ç”¨æ€§**ï¼šJSONæ¨¡å¼å¼€ç®±å³ç”¨ï¼Œæ•°æ®åº“æ¨¡å¼é…ç½®ç®€å•
5. **å®Œæ•´æ€§**ï¼šæ”¯æŒèŠå¤©å†å²æŒä¹…åŒ–

### ä¸‹ä¸€æ­¥
ç¨‹åºå·²å®Œå…¨æ”¯æŒåŒæ¨¡å¼ï¼Œå¯ä»¥ï¼š
1. ç›´æ¥è¿è¡Œæµ‹è¯•ï¼ˆé»˜è®¤JSONæ¨¡å¼ï¼‰
2. é…ç½®æ•°æ®åº“ä½¿ç”¨é«˜çº§åŠŸèƒ½
3. æ ¹æ®éœ€è¦åˆ‡æ¢æ¨¡å¼

---

**å®ç°æ—¥æœŸ**ï¼š2026-01-10
**ç‰ˆæœ¬**ï¼š1.0.0
**çŠ¶æ€**ï¼šâœ… å®Œæˆ
